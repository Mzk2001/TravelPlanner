# 旅游助手Web应用 - 项目架构和目录结构

## 1. 项目整体结构

```
TravelPlanner/
├── README.md                    # 项目说明文档
├── docker-compose.yml          # Docker编排文件
├── .gitignore                  # Git忽略文件
├── .github/                    # GitHub Actions配置
│   └── workflows/
│       └── docker-build.yml
├── backend/                    # Spring Boot后端
│   ├── src/
│   ├── pom.xml
│   ├── Dockerfile
│   └── application.yml
├── frontend/                   # React前端
│   ├── src/
│   ├── package.json
│   ├── Dockerfile
│   ├── vite.config.ts
│   └── tsconfig.json
├── docs/                       # 项目文档
│   ├── PRD.md
│   ├── 技术设计文档.md
│   ├── API文档.md
│   └── 部署文档.md
└── scripts/                    # 部署脚本
    ├── build.sh
    ├── deploy.sh
    └── init-db.sql
```

## 2. 后端项目结构 (Spring Boot)

```
backend/
├── src/main/java/com/travelplanner/
│   ├── TravelPlannerApplication.java
│   ├── config/                 # 配置类
│   │   ├── SecurityConfig.java
│   │   ├── DatabaseConfig.java
│   │   ├── CorsConfig.java
│   │   └── SwaggerConfig.java
│   ├── controller/             # REST控制器
│   │   ├── AuthController.java
│   │   ├── TripController.java
│   │   ├── ExpenseController.java
│   │   ├── AIController.java
│   │   └── UserController.java
│   ├── service/                # 业务逻辑层
│   │   ├── AuthService.java
│   │   ├── UserService.java
│   │   ├── TripService.java
│   │   ├── ExpenseService.java
│   │   ├── AIService.java
│   │   ├── XunfeiSpeechService.java
│   │   ├── AmapService.java
│   │   └── QwenService.java
│   ├── repository/             # 数据访问层
│   │   ├── UserRepository.java
│   │   ├── TripRepository.java
│   │   ├── TripDetailRepository.java
│   │   └── ExpenseRepository.java
│   ├── entity/                 # 实体类
│   │   ├── User.java
│   │   ├── Trip.java
│   │   ├── TripDetail.java
│   │   └── Expense.java
│   ├── dto/                    # 数据传输对象
│   │   ├── request/
│   │   │   ├── LoginRequest.java
│   │   │   ├── RegisterRequest.java
│   │   │   ├── TripCreateRequest.java
│   │   │   ├── TripPlanRequest.java
│   │   │   └── ExpenseCreateRequest.java
│   │   └── response/
│   │       ├── ApiResponse.java
│   │       ├── LoginResponse.java
│   │       ├── TripResponse.java
│   │       ├── TripDetailResponse.java
│   │       └── ExpenseResponse.java
│   ├── security/               # 安全相关
│   │   ├── JwtUtil.java
│   │   ├── JwtAuthenticationFilter.java
│   │   ├── CustomUserDetailsService.java
│   │   └── SecurityExceptionHandler.java
│   ├── util/                   # 工具类
│   │   ├── Constants.java
│   │   ├── DateUtil.java
│   │   └── ValidationUtil.java
│   ├── exception/              # 异常处理
│   │   ├── GlobalExceptionHandler.java
│   │   ├── BusinessException.java
│   │   └── ErrorCode.java
│   └── mapper/                 # 对象映射
│       ├── TripMapper.java
│       └── ExpenseMapper.java
├── src/main/resources/
│   ├── application.yml         # 主配置文件
│   ├── application-dev.yml     # 开发环境配置
│   ├── application-prod.yml    # 生产环境配置
│   ├── db/migration/           # 数据库迁移脚本
│   │   ├── V1__Create_users_table.sql
│   │   ├── V2__Create_trips_table.sql
│   │   ├── V3__Create_trip_details_table.sql
│   │   └── V4__Create_expenses_table.sql
│   └── static/                 # 静态资源
├── src/test/java/              # 测试代码
│   ├── controller/
│   ├── service/
│   └── repository/
├── pom.xml                     # Maven配置
├── Dockerfile                  # Docker镜像构建文件
└── docker-compose.yml          # 本地开发环境
```

## 3. 前端项目结构 (React + TypeScript)

```
frontend/
├── src/
│   ├── components/             # 通用组件
│   │   ├── common/
│   │   │   ├── Header/
│   │   │   │   ├── Header.tsx
│   │   │   │   ├── Header.module.css
│   │   │   │   └── index.ts
│   │   │   ├── Footer/
│   │   │   ├── Loading/
│   │   │   ├── ErrorBoundary/
│   │   │   └── ConfirmDialog/
│   │   ├── Map/
│   │   │   ├── MapComponent.tsx
│   │   │   ├── MapMarker.tsx
│   │   │   ├── MapRoute.tsx
│   │   │   └── MapComponent.module.css
│   │   ├── VoiceInput/
│   │   │   ├── VoiceInput.tsx
│   │   │   ├── VoiceRecorder.tsx
│   │   │   └── VoiceInput.module.css
│   │   ├── TripCard/
│   │   │   ├── TripCard.tsx
│   │   │   ├── TripCard.module.css
│   │   │   └── index.ts
│   │   ├── ExpenseChart/
│   │   │   ├── ExpenseChart.tsx
│   │   │   ├── BudgetAnalysis.tsx
│   │   │   └── ExpenseChart.module.css
│   │   └── index.ts
│   ├── pages/                  # 页面组件
│   │   ├── Home/
│   │   │   ├── Home.tsx
│   │   │   ├── Home.module.css
│   │   │   ├── QuickStart.tsx
│   │   │   └── index.ts
│   │   ├── TripPlan/
│   │   │   ├── TripPlan.tsx
│   │   │   ├── TripPlan.module.css
│   │   │   ├── PlanForm.tsx
│   │   │   ├── PlanResult.tsx
│   │   │   └── index.ts
│   │   ├── TripDetail/
│   │   │   ├── TripDetail.tsx
│   │   │   ├── TripDetail.module.css
│   │   │   ├── DaySchedule.tsx
│   │   │   ├── ExpenseList.tsx
│   │   │   └── index.ts
│   │   ├── Profile/
│   │   │   ├── Profile.tsx
│   │   │   ├── Profile.module.css
│   │   │   ├── TripHistory.tsx
│   │   │   └── index.ts
│   │   ├── Settings/
│   │   │   ├── Settings.tsx
│   │   │   ├── Settings.module.css
│   │   │   ├── ApiKeyConfig.tsx
│   │   │   ├── Preferences.tsx
│   │   │   └── index.ts
│   │   ├── Login/
│   │   │   ├── Login.tsx
│   │   │   ├── Login.module.css
│   │   │   └── index.ts
│   │   ├── Register/
│   │   │   ├── Register.tsx
│   │   │   ├── Register.module.css
│   │   │   └── index.ts
│   │   └── index.ts
│   ├── services/               # API服务
│   │   ├── api.ts              # API客户端配置
│   │   ├── auth.ts             # 认证相关API
│   │   ├── trip.ts             # 行程相关API
│   │   ├── expense.ts          # 费用相关API
│   │   ├── ai.ts               # AI相关API
│   │   └── types.ts            # API类型定义
│   ├── store/                  # 状态管理
│   │   ├── authSlice.ts        # 认证状态
│   │   ├── tripSlice.ts        # 行程状态
│   │   ├── expenseSlice.ts     # 费用状态
│   │   ├── uiSlice.ts          # UI状态
│   │   └── store.ts            # Store配置
│   ├── hooks/                  # 自定义Hooks
│   │   ├── useAuth.ts
│   │   ├── useTrip.ts
│   │   ├── useExpense.ts
│   │   ├── useVoiceRecorder.ts
│   │   └── useMap.ts
│   ├── utils/                  # 工具函数
│   │   ├── constants.ts        # 常量定义
│   │   ├── helpers.ts          # 辅助函数
│   │   ├── validators.ts       # 验证函数
│   │   ├── formatters.ts       # 格式化函数
│   │   └── storage.ts          # 本地存储
│   ├── types/                  # TypeScript类型定义
│   │   ├── auth.ts
│   │   ├── trip.ts
│   │   ├── expense.ts
│   │   ├── api.ts
│   │   └── common.ts
│   ├── styles/                 # 全局样式
│   │   ├── globals.css
│   │   ├── variables.css
│   │   └── antd-override.css
│   ├── assets/                 # 静态资源
│   │   ├── images/
│   │   ├── icons/
│   │   └── fonts/
│   ├── App.tsx                 # 根组件
│   ├── App.module.css          # 根组件样式
│   ├── main.tsx                # 入口文件
│   └── vite-env.d.ts           # Vite类型声明
├── public/                     # 公共资源
│   ├── index.html
│   ├── favicon.ico
│   └── manifest.json
├── package.json                # 依赖配置
├── package-lock.json           # 依赖锁定文件
├── tsconfig.json               # TypeScript配置
├── tsconfig.node.json          # Node.js TypeScript配置
├── vite.config.ts              # Vite配置
├── tailwind.config.js          # Tailwind CSS配置
├── Dockerfile                  # Docker镜像构建文件
└── .env.example                # 环境变量示例
```

## 4. 配置文件结构

### 4.1 后端配置文件

#### application.yml (主配置)
```yaml
spring:
  application:
    name: travelplanner-backend
  profiles:
    active: dev
  datasource:
    url: jdbc:postgresql://localhost:5432/travelplanner
    username: ${DB_USERNAME:travelplanner}
    password: ${DB_PASSWORD:password}
    driver-class-name: org.postgresql.Driver
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

server:
  port: 8080
  servlet:
    context-path: /api

logging:
  level:
    com.travelplanner: DEBUG
    org.springframework.security: DEBUG

# 第三方服务配置
app:
  jwt:
    secret: ${JWT_SECRET:your-secret-key}
    expiration: 86400000
  xunfei:
    app-id: ${XUNFEI_APP_ID:}
    api-key: ${XUNFEI_API_KEY:}
    api-secret: ${XUNFEI_API_SECRET:}
  amap:
    api-key: ${AMAP_API_KEY:}
  qwen:
    api-key: ${QWEN_API_KEY:}
    api-url: ${QWEN_API_URL:https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation}
```

### 4.2 前端配置文件

#### vite.config.ts
```typescript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
      '@components': path.resolve(__dirname, './src/components'),
      '@pages': path.resolve(__dirname, './src/pages'),
      '@services': path.resolve(__dirname, './src/services'),
      '@store': path.resolve(__dirname, './src/store'),
      '@utils': path.resolve(__dirname, './src/utils'),
      '@types': path.resolve(__dirname, './src/types'),
    }
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, '/api')
      }
    }
  },
  build: {
    outDir: 'dist',
    sourcemap: false,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom'],
          antd: ['antd'],
          redux: ['@reduxjs/toolkit', 'react-redux']
        }
      }
    }
  }
})
```

#### package.json
```json
{
  "name": "travelplanner-frontend",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 0",
    "lint:fix": "eslint . --ext ts,tsx --fix"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-router-dom": "^6.8.0",
    "@reduxjs/toolkit": "^1.9.0",
    "react-redux": "^8.0.0",
    "antd": "^5.0.0",
    "@ant-design/icons": "^5.0.0",
    "axios": "^1.3.0",
    "dayjs": "^1.11.0",
    "echarts": "^5.4.0",
    "echarts-for-react": "^3.0.0"
  },
  "devDependencies": {
    "@types/react": "^18.0.0",
    "@types/react-dom": "^18.0.0",
    "@typescript-eslint/eslint-plugin": "^5.0.0",
    "@typescript-eslint/parser": "^5.0.0",
    "@vitejs/plugin-react": "^3.0.0",
    "eslint": "^8.0.0",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-react-refresh": "^0.3.0",
    "typescript": "^4.9.0",
    "vite": "^4.0.0"
  }
}
```

## 5. Docker配置

### 5.1 后端Dockerfile
```dockerfile
FROM openjdk:17-jdk-slim

WORKDIR /app

# 复制Maven配置文件
COPY pom.xml .
COPY .mvn .mvn
COPY mvnw .

# 下载依赖
RUN ./mvnw dependency:go-offline -B

# 复制源代码
COPY src src

# 构建应用
RUN ./mvnw clean package -DskipTests

# 运行应用
EXPOSE 8080
CMD ["java", "-jar", "target/travelplanner-backend-1.0.0.jar"]
```

### 5.2 前端Dockerfile
```dockerfile
FROM node:18-alpine as builder

WORKDIR /app

# 复制package文件
COPY package*.json ./

# 安装依赖
RUN npm ci --only=production

# 复制源代码
COPY . .

# 构建应用
RUN npm run build

# 生产环境
FROM nginx:alpine

# 复制构建结果
COPY --from=builder /app/dist /usr/share/nginx/html

# 复制nginx配置
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### 5.3 docker-compose.yml
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_DB: travelplanner
      POSTGRES_USER: travelplanner
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./scripts/init-db.sql:/docker-entrypoint-initdb.d/init-db.sql

  backend:
    build: ./backend
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=docker
      - DB_HOST=postgres
    depends_on:
      - postgres
    volumes:
      - ./backend/logs:/app/logs

  frontend:
    build: ./frontend
    ports:
      - "3000:80"
    depends_on:
      - backend

volumes:
  postgres_data:
```

## 6. GitHub Actions配置

### 6.1 .github/workflows/docker-build.yml
```yaml
name: Build and Push Docker Images

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-backend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          java-version: '17'
          distribution: 'temurin'
      
      - name: Build backend
        run: |
          cd backend
          ./mvnw clean package -DskipTests
      
      - name: Build Docker image
        run: |
          cd backend
          docker build -t travelplanner-backend:${{ github.sha }} .
      
      - name: Push to Aliyun Registry
        run: |
          docker tag travelplanner-backend:${{ github.sha }} registry.cn-hangzhou.aliyuncs.com/your-namespace/travelplanner-backend:${{ github.sha }}
          docker push registry.cn-hangzhou.aliyuncs.com/your-namespace/travelplanner-backend:${{ github.sha }}

  build-frontend:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json
      
      - name: Install dependencies
        run: |
          cd frontend
          npm ci
      
      - name: Build frontend
        run: |
          cd frontend
          npm run build
      
      - name: Build Docker image
        run: |
          cd frontend
          docker build -t travelplanner-frontend:${{ github.sha }} .
      
      - name: Push to Aliyun Registry
        run: |
          docker tag travelplanner-frontend:${{ github.sha }} registry.cn-hangzhou.aliyuncs.com/your-namespace/travelplanner-frontend:${{ github.sha }}
          docker push registry.cn-hangzhou.aliyuncs.com/your-namespace/travelplanner-frontend:${{ github.sha }}
```

## 7. 环境变量配置

### 7.1 .env.example (前端)
```env
# API配置
VITE_API_BASE_URL=http://localhost:8080/api
VITE_AMAP_API_KEY=your_amap_api_key

# 其他配置
VITE_APP_TITLE=旅游助手
VITE_APP_VERSION=1.0.0
```

### 7.2 .env.example (后端)
```env
# 数据库配置
DB_USERNAME=travelplanner
DB_PASSWORD=password
DB_HOST=localhost
DB_PORT=5432

# Redis配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# JWT配置
JWT_SECRET=your-jwt-secret-key

# 第三方服务配置
XUNFEI_APP_ID=your_xunfei_app_id
XUNFEI_API_KEY=your_xunfei_api_key
XUNFEI_API_SECRET=your_xunfei_api_secret

AMAP_API_KEY=your_amap_api_key

# 通义千问配置
QWEN_API_KEY=your_qwen_api_key
QWEN_API_URL=https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation
```

## 8. 开发环境启动脚本

### 8.1 scripts/start-dev.sh
```bash
#!/bin/bash

echo "启动开发环境..."

# 启动数据库
docker-compose up -d postgres

# 等待数据库启动
sleep 10

# 启动后端
cd backend
./mvnw spring-boot:run &
BACKEND_PID=$!

# 启动前端
cd ../frontend
npm run dev &
FRONTEND_PID=$!

echo "开发环境已启动"
echo "前端: http://localhost:3000"
echo "后端: http://localhost:8080"
echo "数据库: localhost:5432"

# 等待用户中断
wait $BACKEND_PID $FRONTEND_PID
```

### 8.2 scripts/build.sh
```bash
#!/bin/bash

echo "构建项目..."

# 构建后端
cd backend
./mvnw clean package -DskipTests
cd ..

# 构建前端
cd frontend
npm run build
cd ..

echo "构建完成"
```

这个项目架构设计充分考虑了您的要求：
1. 使用Spring Boot作为后端框架
2. 前后端分离的架构
3. 完整的Docker化部署方案
4. GitHub Actions自动化构建
5. 清晰的目录结构和配置管理
6. 支持API密钥的安全配置

接下来我可以帮您生成具体的API接口规范和数据库设计文档。
